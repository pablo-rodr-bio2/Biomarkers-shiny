p
str(p)
View(p)
p
runApp('Biomarkers_2022/Biomarkers-shiny')
runApp('Biomarkers_2022/Biomarkers-shiny')
poolClose(pool)
poolClose(pool)
runApp('Biomarkers_2022/Biomarkers-shiny')
runApp('Biomarkers_2022/Biomarkers-shiny')
shiny::runApp('biomarkers_2022/Biomarkers-shiny')
shiny::runApp('biomarkers_2022/Biomarkers-shiny')
shiny::runApp('biomarkers_2022/Biomarkers-shiny')
shiny::runApp('biomarkers_2022/Biomarkers-shiny')
shiny::runApp('biomarkers_2022/Biomarkers-shiny')
renderPlot(mtcars)
shiny::runApp('biomarkers_2022/Biomarkers-shiny')
shiny::runApp('biomarkers_2022/Biomarkers-shiny')
shiny::runApp('biomarkers_2022/Biomarkers-shiny')
shiny::runApp('biomarkers_2022/Biomarkers-shiny')
shiny::runApp('biomarkers_2022/Biomarkers-shiny')
shiny::runApp('biomarkers_2022/Biomarkers-shiny')
plot(mtcars)
shiny::runApp('biomarkers_2022/Biomarkers-shiny')
shiny::runApp('biomarkers_2022/Biomarkers-shiny')
shiny::runApp('biomarkers_2022/Biomarkers-shiny')
shiny::runApp('biomarkers_2022/Biomarkers-shiny')
shiny::runApp('biomarkers_2022/Biomarkers-shiny')
library(devtools)
install_bitbucket("ibi_group/disgenet2r")
library(disgenet2r)
results <- gene2disease( gene = c( "KCNE1", "KCNE2", "KCNH1", "KCNH2", "KCNG1"), verbose = TRUE)
shiny::runApp('biomarkers_2022/Biomarkers-shiny')
shiny::runApp('biomarkers_2022/Biomarkers-shiny')
shiny::runApp('biomarkers_2022/Biomarkers-shiny')
shiny::runApp('biomarkers_2022/Biomarkers-shiny')
runApp('biomarkers_2022/Biomarkers-shiny')
library(disgenet2r)
results <- gene2disease( gene = c( "KCNE1", "KCNE2", "KCNH1", "KCNH2", "KCNG1"), verbose = TRUE)
get_disgenet_api_key(email = "pablo.rodriguez.bio2@gmail.com", password = "aB6Dnpf2GQdK73w" )
# [1] "05c34c7434f2836ef8f2ea4d84f71f38bb0791b5"
results <- gene2disease( gene = c( "KCNE1", "KCNE2", "KCNH1", "KCNH2", "KCNG1"),
verbose = TRUE, api_key = "05c34c7434f2836ef8f2ea4d84f71f38bb0791b5")
results
str(results)
results@qresult
r <-httr::POST(url = "https://www.disgenet.org/api/auth/",
httr::add_headers(.headers=c( `accept` = '*/*')),
body = list(`email` ="pablo.rodriguez.bio2@gmail.com",`password` = "aB6Dnpf2GQdK73w"))
r
str(r)
jsonlite::fromJSON(httr::content( r, as = "text", encoding = "UTF-8"), flatten = F)$token
# [1] "05c34c7434f2836ef8f2ea4d84f71f38bb0791b5"
results <- gene2disease( gene = c( "KCNE1", "KCNE2", "KCNH1", "KCNH2", "KCNG1"),
verbose = TRUE, api_key = "1f35b7de65d4d77f0a6234544b9ab52684137c42")
results@qresult
shiny::runApp('biomarkers_2022/Biomarkers-shiny')
runApp('biomarkers_2022/Biomarkers-shiny')
runApp('biomarkers_2022/Biomarkers-shiny')
runApp('biomarkers_2022/Biomarkers-shiny')
runApp('biomarkers_2022/Biomarkers-shiny')
runApp('biomarkers_2022/Biomarkers-shiny')
runApp('biomarkers_2022/Biomarkers-shiny')
runApp('biomarkers_2022/Biomarkers-shiny')
runApp('biomarkers_2022/Biomarkers-shiny')
runApp('biomarkers_2022/Biomarkers-shiny')
runApp('biomarkers_2022/Biomarkers-shiny')
runApp('biomarkers_2022/Biomarkers-shiny')
runApp('biomarkers_2022/Biomarkers-shiny')
runApp('biomarkers_2022/Biomarkers-shiny')
runApp('biomarkers_2022/Biomarkers-shiny')
install.packages("languageserver")
runApp('biomarkers_2022/Biomarkers-shiny')
runApp('biomarkers_2022/Biomarkers-shiny')
runApp('biomarkers_2022/Biomarkers-shiny')
runApp('biomarkers_2022/Biomarkers-shiny')
runApp('biomarkers_2022/Biomarkers-shiny')
runApp('biomarkers_2022/Biomarkers-shiny')
runApp('biomarkers_2022/Biomarkers-shiny')
runApp('biomarkers_2022/Biomarkers-shiny')
runApp('biomarkers_2022/Biomarkers-shiny')
versions()
runApp('biomarkers_2022/Biomarkers-shiny')
runApp('biomarkers_2022/Biomarkers-shiny')
runApp('biomarkers_2022/Biomarkers-shiny')
install.packages("BiocStyle")
BiocManager::install("BiocStyle")
runApp('biomarkers_2022/Biomarkers-shiny')
runApp('biomarkers_2022/Biomarkers-shiny')
runApp('biomarkers_2022/Biomarkers-shiny')
runApp('biomarkers_2022/Biomarkers-shiny')
runApp('biomarkers_2022/Biomarkers-shiny')
runApp('biomarkers_2022/Biomarkers-shiny')
runApp('biomarkers_2022/Biomarkers-shiny')
runApp('biomarkers_2022/Biomarkers-shiny')
runApp('biomarkers_2022/Biomarkers-shiny')
runApp('biomarkers_2022/Biomarkers-shiny')
runApp('biomarkers_2022/Biomarkers-shiny')
runApp('biomarkers_2022/Biomarkers-shiny')
runApp('biomarkers_2022/Biomarkers-shiny')
runApp('biomarkers_2022/Biomarkers-shiny')
runApp('biomarkers_2022/Biomarkers-shiny')
runApp('biomarkers_2022/Biomarkers-shiny')
runApp('biomarkers_2022/Biomarkers-shiny')
runApp('biomarkers_2022/Biomarkers-shiny')
runApp('biomarkers_2022/Biomarkers-shiny')
library(shiny)
library(RMariaDB)
library(DT)
library(shinycustomloader)
library(dplyr)
library(bslib)
library(pool)
library(ggplot2)
library(plotly)
library(ggrepel)
library(ggpubr)
library(shiny)
library(DT)
library(shinycustomloader)
library(dplyr)
## merge dATA
rm(list =ls())
library(data.table)
library(dplyr)
library(hrbrthemes)
library(extrafont)
library(viridis)
library(DT)
library(plotly)
library(ggpubr)
library(VennDiagram)
library(eulerr)
library(Cairo)
library(cowplot)
library(janitor)
library(ggrepel)
library(readr)
library(tidyr)
library(forcats)
gdas <- fread( "/home/janet/Documents/CLINICAL_TRIALS_DATA_MINING/DATA/database/load_files/gene_condition_summary.tsv")
gdas
conditions  <- fread( "/home/janet/Documents/CLINICAL_TRIALS_DATA_MINING/DATA/database/load_files/diseases.tsv")
conditions
dclass  <- fread( "/home/janet/Documents/CLINICAL_TRIALS_DATA_MINING/DATA/database/load_files/disease2diseaseclass.tsv")
dclass
meshtree <- fread("/home/janet/Documents/CLINICAL_TRIALS_DATA_MINING/DATA/processed_data/mesh/meshTree.tsv", header = T)
meshtree$disease_class <- gsub("^([A-Z][0-9]+)\\..*$", "\\1",meshtree$treeid)
disease2classname <- meshtree[ treeid == disease_class] %>% select(disease_class, name) %>% unique()
disease2classname
meshtree
disease2classname
dclass <- merge(dclass, disease2classname , by = "disease_class")
dclass
dc <- c(paste0("C0", 1:9 ), paste0("C", 10:26), paste0("F0", 1:3),paste0("G0", 1:9), paste0("G", 10:17))
dc <- setdiff(dc, "C22")
dc <- setdiff(dc, "G15")
dclass
dclass <- dclass[disease_class %in% dc]
dclass
gdas
length(unique(gdas$V14))
gdas_class <- merge(gdas, dclass, by.x = "V14", by.y = "meshid")
gdas_class <- merge(gdas, dclass, by.x = "V14", by.y = "meshid", allow.cartesian = T)
length(unique(gdas_class$V14))
gdas[ ! V14 %in% dclass$disease_class]
gdas[ ! V14 %in% dclass$meshid]
gdas_class
gdas_class <- gdas_class %>% select(GeneID, Symbol, V14, disease_class, name.y) %>% unique()
gdas_class
gdas_class <- rename(gdas_class, class_name = name.y)
gdas_class
gdas_class
gdas_class %>% dplyr::group_by(GeneID, disease_class ) %>%
dplyr::summarise(ndisinclass = n(disease_class)) %>%  arrange(desc(ndisinclass) )
gdas_class %>% dplyr::group_by(GeneID, disease_class ) %>%
dplyr::summarise(ndisinclass = n_distinct(disease_class)) %>%  arrange(desc(ndisinclass) )
gdas_class %>% dplyr::group_by(GeneID, disease_class ) %>%
dplyr::summarise(ndisinclass = n(disease_class)) %>%  arrange(desc(ndisinclass) )
gdas_class %>% dplyr::group_by(GeneID, disease_class ) %>%
dplyr::summarise(ndisinclass = count(disease_class)) %>%  arrange(desc(ndisinclass) )
gdas_class %>% dplyr::group_by(GeneID, disease_class ) %>%
dplyr::summarise(ndisinclass = n(disease_class)) %>%  arrange(desc(ndisinclass) )
gdas_class %>% dplyr::group_by(GeneID, disease_class ) %>%
dplyr::summarise(ndisinclass = n_distinct(disease_class)) %>%  arrange(desc(ndisinclass) )
?summarise
as.data.frame(table(gdas_class$disease_class))
as.data.frame(table(gdas_class$GeneID, gdas_class$disease_class))
g2class <- as.data.frame(table(gdas_class$GeneID, gdas_class$disease_class))
g2class
g2class <- g2class[ g2class$Freq>0,]
g2class
g2class[1,]
reshape2::dcast(g2class, Var1~Var2, value.var = "Freq")
g2class <- as.data.frame(table(gdas_class$Symbol, gdas_class$disease_class))
g2class <- g2class[ g2class$Freq>0,]
reshape2::dcast(g2class, Var1~Var2, value.var = "Freq")
g2class <- g2class[ g2class$Freq>0,]
g2class
g2class <- g2class[ g2class$Freq>4,]
g2class <- g2class[ g2class$Freq>9,]
reshape2::dcast(g2class, Var1~Var2, value.var = "Freq")
g2class <- as.data.frame(table(gdas_class$Symbol, gdas_class$disease_class))
g2class <- g2class[ g2class$Freq>9,]
g2class
aa <- gdas_class %>% select(  Symbol, V14, disease_class ) %>% unique()
aa
aa <- as.data.frame(table(aa$Symbol))
aa
aa[1,]
g2class[1,]
g2class <- merge(g2class, aa, by = "Var1")
g2class[1,]
g2class$percent <- g2class$Freq.x/g2class$Freq.y *100
g2class
g2class <- reshape2::dcast(g2class, Var1~Var2, value.var = "percent")
g2class
g2class[is.na(g2class)] <- 0
g2class
rownames(g2class) <- g2class$Var1
g2class
ComplexHeatmap::Heatmap(g2class[-1])
g2class[ g2class$C04>0]
g2class[ g2class$C04>0 ,]
colSums(g2class[-1])
aa <- gdas_class %>% select(  Symbol, V14, disease_class ) %>% unique()
aa <- as.data.frame(table(aa$disease_class))
aa
findisclass <- subset(aa, Freq > 100)
findisclass
findisclass$Var1
findisclass$Var1 %>%length()
findisclass <- subset(aa, Freq > 100)$Var1
ComplexHeatmap::Heatmap(g2class[findisclass])
ComplexHeatmap::Heatmap(g2class[, findisclass])
g2class[, findisclass]
findisclass
g2class[1,]
findisclass <- subset(aa, Freq > 100)$Var1 %>% as.character()
ComplexHeatmap::Heatmap(g2class[, findisclass])
g2class[, findisclass]
g2class[ findisclass]
g2class[ findisclass,]
findisclass
setdiff(colnames(g2class))
setdiff(colnames(g2class),findisclass)
findisclass
g2class[ , c(findisclass)]
setdiff(colnames(g2class),findisclass)
str(g2class)
g2class <- data.table(g2class)
g2class[ , ..findisclass)]
g2class[ , ..findisclass]
colnames(g2class)
findisclass <- intersect(findisclass, colnames(g2class))
ComplexHeatmap::Heatmap(g2class[, findisclass])
ComplexHeatmap::Heatmap(g2class[, ..findisclass])
g2class
g2class <- as.data.frame(table(gdas_class$Symbol, gdas_class$disease_class))
g2class <- g2class[ g2class$Freq>9,]
aa <- gdas_class %>% select(  Symbol, V14, disease_class ) %>% unique()
aa <- as.data.frame(table(aa$Symbol))
g2class <- merge(g2class, aa, by = "Var1")
g2class$percent <- g2class$Freq.x/g2class$Freq.y *100
g2class <- reshape2::dcast(g2class, Var1~Var2, value.var = "percent")
g2class[is.na(g2class)] <- 0
rownames(g2class) <- g2class$Var1
aa <- gdas_class %>% select(  Symbol, V14, disease_class ) %>% unique()
aa <- as.data.frame(table(aa$disease_class))
findisclass <- subset(aa, Freq > 100)$Var1 %>% as.character()
findisclass <- intersect(findisclass, colnames(g2class))
ComplexHeatmap::Heatmap(g2class[, findisclass])
aa
g2class[ C04 > 0]
g2class[ g2class$C04 > 0, ]
g2class[ g2class$C04 > 0 & g2class$C23 == 0, ]
g2class[ g2class$C04 > 0 & g2class$C23 == 0 & gdas_class$C15 == 0, ]
g2class[ g2class$C04 > 0 & g2class$C23 == 0 & gdas_class$C15 == 0.00, ]
gdas_class <- merge(gdas, dclass, by.x = "V14", by.y = "meshid", allow.cartesian = T)
length(unique(gdas_class$V14))
gdas_class <- gdas_class %>% select(GeneID, Symbol, V14, disease_class, name.y) %>% unique()
gdas_class <- rename(gdas_class, class_name = name.y)
# gdas_class %>% dplyr::group_by(GeneID, disease_class ) %>%
#   dplyr::summarise(ndisinclass = n(disease_class)) %>%  arrange(desc(ndisinclass) )
g2class <- as.data.frame(table(gdas_class$Symbol, gdas_class$disease_class))
g2class <- g2class[ g2class$Freq>9,]
aa <- gdas_class %>% select(  Symbol, V14, disease_class ) %>% unique()
aa <- as.data.frame(table(aa$Symbol))
g2class <- merge(g2class, aa, by = "Var1")
g2class$percent <- g2class$Freq.x/g2class$Freq.y *100
g2class <- reshape2::dcast(g2class, Var1~Var2, value.var = "percent")
g2class[is.na(g2class)] <- 0
gdas_class <- merge(gdas, dclass, by.x = "V14", by.y = "meshid", allow.cartesian = T)
length(unique(gdas_class$V14))
gdas_class <- gdas_class %>% select(GeneID, Symbol, V14, disease_class, name.y) %>% unique()
gdas_class <- rename(gdas_class, class_name = name.y)
# gdas_class %>% dplyr::group_by(GeneID, disease_class ) %>%
#   dplyr::summarise(ndisinclass = n(disease_class)) %>%  arrange(desc(ndisinclass) )
g2class <- as.data.frame(table(gdas_class$Symbol, gdas_class$disease_class))
g2class <- g2class[ g2class$Freq>9,]
aa <- gdas_class %>% select(  Symbol, V14, disease_class ) %>% unique()
aa <- as.data.frame(table(aa$Symbol))
g2class <- merge(g2class, aa, by = "Var1")
g2class$percent <- round(g2class$Freq.x/g2class$Freq.y *100, digits = 1)
g2class <- reshape2::dcast(g2class, Var1~Var2, value.var = "percent")
g2class[is.na(g2class)] <- 0
rownames(g2class) <- g2class$Var1
aa <- gdas_class %>% select(  Symbol, V14, disease_class ) %>% unique()
aa <- as.data.frame(table(aa$disease_class))
findisclass <- subset(aa, Freq > 100)$Var1 %>% as.character()
findisclass <- intersect(findisclass, colnames(g2class))
ComplexHeatmap::Heatmap(g2class[, findisclass])
g2class
g2class[ g2class$C04 > 0 & g2class$C23  0 & gdas_class$C15 < 0.1, ]
g2class[ g2class$C04 > 0 & g2class$C23  < 0.1 & gdas_class$C15 < 0.1, ]
g2class[ g2class$C04 > 0.1 & g2class$C23  < 0.1 & gdas_class$C15 < 0.1, ]
str(g2class)
g2class[ g2class$C04 > 0.1 & g2class$C23  < 0.1 , ]
g2class[ g2class$C04 > 0.1 & g2class$C15  < 0.1 , ]
g2class[ g2class$C04 > 0.1 & g2class$C23  < 0.1 , ]
g2class[ g2class$C04 > 0.1 & g2class$C23  < 0.1 & gdas_class$C15 < 0.1, ]
g2class[ g2class$C04 > 0.1 & g2class$C23  < 0.1 , ]
findisclass
setdiff(findisclass, "C04")
colSums(g2class[, setdiff(findisclass, "C04")])
g2class
g2class$ssum <- rowSums(g2class[ findisclass])
head(g2class)
g2class <- as.data.frame(table(gdas_class$Symbol, gdas_class$disease_class))
g2class <- g2class[ g2class$Freq>9,]
aa <- gdas_class %>% select(  Symbol, V14, disease_class ) %>% unique()
aa <- as.data.frame(table(aa$Symbol))
g2class <- merge(g2class, aa, by = "Var1")
g2class$percent <- round(g2class$Freq.x/g2class$Freq.y *100, digits = 1)
g2class <- reshape2::dcast(g2class, Var1~Var2, value.var = "percent")
g2class[is.na(g2class)] <- 0
rownames(g2class) <- g2class$Var1
findisclass <- subset(aa, Freq > 1)$Var1 %>% as.character()
findisclass <- intersect(findisclass, colnames(g2class))
findisclass <- subset(aa, Freq > 1)$Var1 %>% as.character()
aa <- gdas_class %>% select(  Symbol, V14, disease_class ) %>% unique()
aa <- as.data.frame(table(aa$disease_class))
findisclass <- subset(aa, Freq > 1)$Var1 %>% as.character()
findisclass
findisclass <- intersect(findisclass, colnames(g2class))
g2class$ssum <- rowSums(g2class[ findisclass])
g2class
g2class <- as.data.frame(table(gdas_class$Symbol, gdas_class$disease_class))
g2class
g2class <- g2class[ g2class$Freq> 0,]
aa <- gdas_class %>% select(  Symbol, V14, disease_class ) %>% unique()
aa <- as.data.frame(table(aa$Symbol))
g2class <- merge(g2class, aa, by = "Var1")
g2class$percent <- round(g2class$Freq.x/g2class$Freq.y *100, digits = 1)
g2class <- reshape2::dcast(g2class, Var1~Var2, value.var = "percent")
g2class[is.na(g2class)] <- 0
rownames(g2class) <- g2class$Var1
aa <- gdas_class %>% select(  Symbol, V14, disease_class ) %>% unique()
aa <- as.data.frame(table(aa$disease_class))
findisclass <- subset(aa, Freq > 1)$Var1 %>% as.character()
findisclass <- intersect(findisclass, colnames(g2class))
g2class$ssum <- rowSums(g2class[ findisclass])
g2class
ComplexHeatmap::Heatmap(g2class[, findisclass])
g2class[ g2class$C04 > 0.1 & g2class$C23  < 0.1 , ]
g2class[ g2class$C04 > 0.1 & g2class$C23  < 0.1 & g2class$C15 < 0.1, ]
g2class[ g2class$C04 > 0.1 & g2class$C23  < 0.1 & g2class$C15 < 0.1 & g2class$C16 < 0.1, ]
g2class[ g2class$C04 > 90, ]
g2class[ g2class$C04 > 80, ]
g2class[ g2class$C04 > 60, ]
g2class[ g2class$C04 > 70, ]
ComplexHeatmap::Heatmap(g2class[ g2class$C04 > 70, ] )
ComplexHeatmap::Heatmap(g2class[ g2class$C04 > 70, findisclass ] )
ComplexHeatmap::Heatmap(g2class[ g2class$C04 > 50, findisclass ] )
ComplexHeatmap::Heatmap(g2class[ g2class$C04 > 60, findisclass ] )
ComplexHeatmap::Heatmap(g2class[ g2class$C04 > 60, findisclass ] , row_names_gp = gpar(fontsize = 8))
disease2classname
gdas_class
g2class <- as.data.frame(table(gdas_class$Symbol, gdas_class$class_name))
table(g2class$Var2)
c(paste0("C0", 1:9 ), paste0("C", 10:26), paste0("F0", 1:3) )
gdas_class <-  gdas_class[ gdas_class$disease_class %in% c(paste0("C0", 1:9 ), paste0("C", 10:26), paste0("F0", 1:3)) ]
g2class <- as.data.frame(table(gdas_class$Symbol, gdas_class$class_name))
g2class <- g2class[ g2class$Freq> 0,]
g2class$Var2
g2class$Var2 %>% table()
gdas_class$name <- gsub(" Diseases", "", gdas_class$class_name)
gdas_class$name %>% table()
gdas_class$name <- gsub(" and Lymphatic", "", gdas_class$class_name)
gdas_class$name <- gsub(" and Injuries", "", gdas_class$class_name)
gdas_class$name <- gsub(" and Connective Tissue", "", gdas_class$class_name)
gdas_class$name %>% table()
gdas_class <-  gdas_class[ gdas_class$disease_class %in% c(paste0("C0", 1:9 ), paste0("C", 10:26), paste0("F0", 1:3)) ]
gdas_class$name <- gsub(" Diseases", "", gdas_class$class_name)
gdas_class$name <- gsub(" and Lymphatic", "", gdas_class$name)
gdas_class$name <- gsub(" and Injuries", "", gdas_class$name)
gdas_class$name <- gsub(" and Connective Tissue", "", gdas_class$name)
gdas_class$name %>% table()
gdas_class$name <- gsub("Chemically-Induced Disorders", "Chemical", gdas_class$name)
gdas_class$name <- gsub("Pathological Conditions, Signs and Symptoms", "Symptoms", gdas_class$name)
gdas_class$name %>% table()
gdas_class$name <- gsub("Mental Disorders", "Mental", gdas_class$name)
gdas_class$name <- gsub(" System", "", gdas_class$name)
gdas_class$name %>% table()
gdas_class$name <- gsub("Disorders of Environmental Origin", "Environmental", gdas_class$name)
gdas_class$name <- gsub("Nutritional and Metabolic", "Metabolic", gdas_class$name)
gdas_class$name <- gsub("Respiratory Tract", "Respiratory", gdas_class$name)
gdas_class$name <- gsub("Psychological Phenomena", "Psychologic", gdas_class$name)
gdas_class$name <- gsub("Congenital, Hereditary, and Neonatal and Abnormalities", "Congenital", gdas_class$name)
gdas_class$name %>% table()
gdas_class$name <- gsub("Behavior and Behavior Mechanisms", "Behavior", gdas_class$name)
gdas_class$name %>% table()
g2class <- as.data.frame(table(gdas_class$Symbol, gdas_class$name))
g2class <- g2class[ g2class$Freq> 0,]
aa <- gdas_class %>% select(  Symbol, V14, disease_class ) %>% unique()
aa <- as.data.frame(table(aa$Symbol))
g2class <- merge(g2class, aa, by = "Var1")
g2class$percent <- round(g2class$Freq.x/g2class$Freq.y *100, digits = 1)
g2class <- reshape2::dcast(g2class, Var1~Var2, value.var = "percent")
g2class[is.na(g2class)] <- 0
rownames(g2class) <- g2class$Var1
aa <- gdas_class %>% select(  Symbol, V14, disease_class ) %>% unique()
aa <- as.data.frame(table(aa$disease_class))
findisclass <- subset(aa, Freq > 1)$Var1 %>% as.character()
findisclass <- intersect(findisclass, colnames(g2class))
ComplexHeatmap::Heatmap(g2class[, findisclass])
g2class
findisclass
aa <- gdas_class %>% select(  Symbol, V14, disease_class ) %>% unique()
aa <- gdas_class %>% select(  Symbol, V14, name) %>% unique()
aa <- as.data.frame(table(aa$name))
findisclass <- subset(aa, Freq > 1)$Var1 %>% as.character()
findisclass <- intersect(findisclass, colnames(g2class))
ComplexHeatmap::Heatmap(g2class[, findisclass])
ComplexHeatmap::Heatmap(g2class[ g2class$C04 > 60, findisclass ] , row_names_gp = gpar(fontsize = 8))
ComplexHeatmap::Heatmap(g2class[ g2class$Neoplasms > 60, findisclass ] , row_names_gp = gpar(fontsize = 8))
ComplexHeatmap::Heatmap(g2class[ g2class$Cardiovascular > 60, findisclass ] , row_names_gp = gpar(fontsize = 8))
drivers <- fread("/home/janet/Documents/DisGeNET_2020/DATA/original_data/CGI/cancer_genes_upon_mutations_or_CNAs.tsv")
drivers$source %>% table()
drivers <- drivers[ grepl("cgc", source) |  grepl("validated",source)]
drivers
g2class[ g2class$Var1 %in% drivers$gene,]
ComplexHeatmap::Heatmap(g2class[ g2class$Var1 %in% drivers$gene,])
ComplexHeatmap::Heatmap(g2class[ g2class$Var1 %in% drivers$gene,findisclass])
ComplexHeatmap::Heatmap(g2class[ g2class$Cardiovascular > 60, findisclass ] , row_names_gp = gpar(fontsize = 8))
ComplexHeatmap::Heatmap(g2class[ g2class$Cardiovascular > 60, findisclass ] , row_names_gp = gpar(fontsize = 8))
ComplexHeatmap::Heatmap(g2class[ g2class$Var1 %in% drivers$gene,findisclass], row_names_gp = gpar(fontsize = 8))
table(drivers$source)
ComplexHeatmap::Heatmap(g2class[ g2class$Var1 %in% drivers[source!="validated"]$gene,findisclass], row_names_gp = gpar(fontsize = 8))
drivers <- drivers[ grepl("cgc", source) ]
ComplexHeatmap::Heatmap(g2class[ g2class$Var1 %in% drivers[source!="validated"]$gene,findisclass], row_names_gp = gpar(fontsize = 8))
ComplexHeatmap::Heatmap(g2class[ g2class$Cardiovascular > 60, findisclass ] , row_names_gp = gpar(fontsize = 8))
ComplexHeatmap::Heatmap(g2class[ g2class$Cardiovascular > 50, findisclass ] , row_names_gp = gpar(fontsize = 8))
gdas_class
gdas_class %>% dplyr::group_by(GeneID, disease_class ) %>%
dplyr::summarise(ndisinclass = n(disease_class))
gdas_class %>% dplyr::group_by(GeneID, disease_class ) %>%
dplyr::count(disease_class))
gdas_class %>% dplyr::group_by(GeneID, disease_class ) %>%
dplyr::count(disease_class)
gdas_class %>% dplyr::group_by(GeneID, disease_class ) %>%
dplyr::count(disease_class) %>% filter(disease_class == "C16")
gdas_class %>% dplyr::group_by(GeneID, disease_class ) %>%
dplyr::count(disease_class) %>% filter(disease_class == "C16") %>% filter(n> 40)
gdas_class %>% dplyr::group_by(Symbol, disease_class ) %>%
dplyr::count(disease_class) %>% filter(disease_class == "C16") %>% filter(n> 40)
gdas_class %>% dplyr::group_by(Symbol, disease_class ) %>%
dplyr::count(disease_class) %>% filter(disease_class == "C16") %>% filter(n> 100)
gdas_class %>% dplyr::group_by(Symbol, disease_class ) %>%
dplyr::count(disease_class) %>% filter(disease_class == "C16") %>% filter(n> 30)
ComplexHeatmap::Heatmap(g2class[ g2class$Cardiovascular > 65, findisclass ] , row_names_gp = gpar(fontsize = 8))
ComplexHeatmap::Heatmap(g2class[ g2class$Cardiovascular > 55, findisclass ] , row_names_gp = gpar(fontsize = 8))
# gdas_class %>% dplyr::group_by(GeneID, disease_class ) %>%
#   dplyr::summarise(ndisinclass = n(disease_class)) %>%  arrange(desc(ndisinclass) )
gdas_class %>% dplyr::group_by(Symbol, V14 ) %>%
dplyr::count(V14) %>%  filter(n> 9)
gdas_class
# gdas_class %>% dplyr::group_by(GeneID, disease_class ) %>%
#   dplyr::summarise(ndisinclass = n(disease_class)) %>%  arrange(desc(ndisinclass) )
gdas_class %>% dplyr::group_by(Symbol ) %>%
dplyr::summarise(n = n_distinct(V14)) %>%  filter(n> 9)
gg <- gdas_class %>% dplyr::group_by(Symbol ) %>%
dplyr::summarise(n = n_distinct(V14)) %>%  filter(n> 9)
gdas
g2class
ComplexHeatmap::Heatmap(g2class[ g2class$Var1 %in% gg$Symbol > 55, findisclass ] , row_names_gp = gpar(fontsize = 8))
ComplexHeatmap::Heatmap(g2class[ g2class$Var1 %in% gg$Symbol  , findisclass ] , row_names_gp = gpar(fontsize = 8))
g2class[ g2class$Var1 %in% gg$Symbol  , findisclass ]
gg
g2class[ g2class$Var1 %in% gg$Symbol  & g2class$Cardiovascular>60, findisclass ]
g2class[ g2class$Var1 %in% gg$Symbol  & g2class$Cardiovascular>40, findisclass ]
g2class[ g2class$Var1 %in% gg$Symbol  & g2class$Cardiovascular>30, findisclass ]
ComplexHeatmap::Heatmap(g2class[ g2class$Var1 %in% gg$Symbol  & g2class$Cardiovascular>30, findisclass ] , row_names_gp = gpar(fontsize = 8))
col=brewer.pal(11,"RdBu")
col=RColorBrewer::brewer.pal(11,"RdBu")
col
?ComplexHeatmap::Heatmap
ComplexHeatmap::Heatmap(g2class[ g2class$Var1 %in% gg$Symbol  & g2class$Cardiovascular>30, findisclass ] , row_names_gp = gpar(fontsize = 8), col=RColorBrewer::brewer.pal(11,"RdBu"))
ComplexHeatmap::Heatmap(g2class[ g2class$Var1 %in% gg$Symbol  & g2class$Cardiovascular>30, findisclass ] , row_names_gp = gpar(fontsize = 8), col=RColorBrewer::colorRampPalette(brewer.pal(10, "RdYlBu"))(256))
ComplexHeatmap::Heatmap(g2class[ g2class$Var1 %in% gg$Symbol  & g2class$Cardiovascular>30, findisclass ] , row_names_gp = gpar(fontsize = 8), col=colorRampPalette(brewer.pal(10, "RdYlBu"))(256))
ComplexHeatmap::Heatmap(g2class[ g2class$Var1 %in% gg$Symbol  & g2class$Cardiovascular>30, findisclass ] , row_names_gp = gpar(fontsize = 8), col=colorRampPalette(RColorBrewer::brewer.pal(10, "RdYlBu"))(256))
ComplexHeatmap::Heatmap(g2class[ g2class$Var1 %in% gg$Symbol  & g2class$Cardiovascular>30, findisclass ] , row_names_gp = gpar(fontsize = 8), col=colorRampPalette(RColorBrewer::brewer.pal(10, "YlOrRd"))(256))
ComplexHeatmap::Heatmap(g2class[ g2class$Var1 %in% gg$Symbol  & g2class$Congenital>30, findisclass ] , row_names_gp = gpar(fontsize = 8), col=colorRampPalette(RColorBrewer::brewer.pal(10, "RdYlBu"))(256))
ComplexHeatmap::Heatmap(g2class[ g2class$Var1 %in% gg$Symbol  & g2class$Congenital>10, findisclass ] , row_names_gp = gpar(fontsize = 8), col=colorRampPalette(RColorBrewer::brewer.pal(10, "RdYlBu"))(256))
ComplexHeatmap::Heatmap(g2class[ g2class$Var1 %in% gg$Symbol  & g2class$Congenital>10, findisclass ] , row_names_gp = gpar(fontsize = 8), col=colorRampPalette(RColorBrewer::brewer.pal(10, "YlOrRd"))(256))
ComplexHeatmap::Heatmap(g2class[ g2class$Var1 %in% gg$Symbol  & g2class$Chemical>10, findisclass ] , row_names_gp = gpar(fontsize = 8), col=colorRampPalette(RColorBrewer::brewer.pal(10, "YlOrRd"))(256))
ComplexHeatmap::Heatmap(g2class[ g2class$Var1 %in% gg$Symbol  & g2class$Endocrine>10, findisclass ] , row_names_gp = gpar(fontsize = 8), col=colorRampPalette(RColorBrewer::brewer.pal(10, "YlOrRd"))(256))
ComplexHeatmap::Heatmap(g2class[ g2class$Var1 %in% gg$Symbol  & g2class$Endocrine>30, findisclass ] , row_names_gp = gpar(fontsize = 8), col=colorRampPalette(RColorBrewer::brewer.pal(10, "YlOrRd"))(256))
ComplexHeatmap::Heatmap(g2class[ g2class$Var1 %in% gg$Symbol  & g2class$Endocrine>20, findisclass ] , row_names_gp = gpar(fontsize = 8), col=colorRampPalette(RColorBrewer::brewer.pal(10, "YlOrRd"))(256))
ComplexHeatmap::Heatmap(g2class[ g2class$Var1 %in% gg$Symbol  & g2class$Immune>20, findisclass ] , row_names_gp = gpar(fontsize = 8), col=colorRampPalette(RColorBrewer::brewer.pal(10, "YlOrRd"))(256))
ComplexHeatmap::Heatmap(g2class[ g2class$Var1 %in% gg$Symbol  & g2class$Mental>20, findisclass ] , row_names_gp = gpar(fontsize = 8), col=colorRampPalette(RColorBrewer::brewer.pal(10, "YlOrRd"))(256))
g2class[ g2class$Var1 %in% gg$Symbol  & g2class$Mental>20, findisclass ]
